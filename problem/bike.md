# 共享自行車 (bike)

## 問題描述

某觀光區有提供免費自行車的服務，自行車有 $`n`$ 個租借站，編號為 $`1`$ 至 $`n`$。
一開始每個租借站皆有 $`k`$ 台自行車，每天開放租借的時間為早上六點到晚上十點，
市長選舉時承諾可以甲地借乙地還，所以每天到晚上十點時，每個租借站的自行車數量可能改變，
我們把十點時第 $`i`$ 個租借站的自行車數量記作 $`w_i`$。因為逾時歸還要給付大筆違約金，
所以可以假設使用者都會在十點前將自行車歸還到某一個租借站，也就是說 $`\displaystyle\sum_{i=1}^n w_i = n\times k`$。
到隔天早上六點之前，租借服務要調度一些腳踏車，使每個租借站都恢復成恰有 $`k`$ 台自行車的狀態。
每台自行車都是一樣的，所以哪一台在哪個租借站並無關係，只需每個租借站的自行車數量都是 $`k`$ 就可以了。

該觀光區道路不多，自行車調度必須使用這些道路，已知任兩個租借站之間皆恰有一條簡單路徑可以通達，
每條道路有其長度，每天晚上調度的成本為所有自行車移動距離的總和。
現在給你某天晚上十點時各租借站自行車的數量，
希望請你給出一個總成本最小的方案調度自行車讓各租借站點自行車數量恢復為 $`k`$ 台。

下圖是一個 $`n = 8`$、$`k = 2`$ 的例子，點上標示的各租借站目前的腳踏車數量，邊上標示的是道路長度。
在本例中，依照虛線的路徑各調度一台車是總調度距離最小的方式，其距離總和為：
$$(3 + 1 + 2) + (3 + 3 + 3) + (3) + (2 + 1) = 21$$

\begin{figure}[h]
  \centering
  \begin{tikzpicture}
    \def \Nodes {
      1/0/4/4,
      2/4/2/2,
      3/2/0/2,
      4/0/2/1,
      5/8/2/3,
      6/10/4/3,
      7/10/1/1,
      8/6/0/0}
    \def \Edges {
      1/2/3/above,
      2/3/1/right,
      3/4/2/below,
      2/5/3/above,
      5/6/2/left,
      5/7/1/below,
      5/8/3/right}

    \foreach \id / \x / \y / \w in \Nodes {
      \node[draw,circle] (\id) at (\x, \y) {$\w$};
    }
    \foreach \x / \y / \w / \labelpos in \Edges {
      \path[draw,-,thick] (\x) -- (\y) node[midway,\labelpos] {$\w$};
    }

    \draw [red,->,dashed] plot [smooth] coordinates {(0.25,3.5) (3.5,2) (2,0.5) (0.5,1.75)};
    \draw [red,->,dashed] plot [smooth] coordinates {(0.5,4) (4.25,2.25) (7.5,2.0) (6,0.5)};
    \draw [red,->,dashed] plot [smooth] coordinates {(9.75,3.5) (8.5,2) (9.5,1.5)};
    \draw [red,->,dashed] plot [smooth] coordinates {(7.75,1.5) (6.5,0.25)};
  \end{tikzpicture}
\end{figure}


## 輸入格式

\begin{format}
\f{
$n$ $k$
$w_1$ $w_2$ $\cdots$ $w_n$
$u_1$ $v_1$ $d_1$
$u_2$ $v_2$ $d_2$
$\vdots$
$u_{n-1}$ $v_{n-1}$ $d_{n-1}$
}
\end{format}

* $`n`$ 代表自行車租借站數量
* $`w_i`$ 代表第 $`i`$ 租借站的自行車數量
* 第 $`i`$ 條道路連接租借站 $`u_i`$ 與 $`v_i`$，且距離為 $`d_i`$

## 輸出格式

\begin{format}
\f{
$D$
}
\end{format}

* $`D`$ 為整數，代表最小的調度距離總和

## 測資限制

* $`1 \le n \le 10^5`$
* $`1 \le k \le 10`$
* $`1 \le u_i, v_i \le n`$，$`u_i \neq v_i`$
* $`1 \le d_i \le 1000`$
* $`\displaystyle\sum_{i=1}^n w_i = n\times k`$
* $`0 \leq w_i \leq n\times k`$
* 上述變數皆為整數

## 範例測試

## 評分說明

本題共有四組子任務，條件限制如下所示。
每一組可有一或多筆測試資料，該組所有測試資料皆需答對才會獲得該組分數。

|  子任務  |  分數  | 額外輸入限制 |
| :------: | :----: | ------------ |
| 1 | {{score.subtask1}} | $`n \le 100`$ |
| 2 | {{score.subtask2}} | 自行車數量超過 $`k`$ 的租借站數量恰有一個 |
| 3 | {{score.subtask3}} | 所有租借站位於一條直線上，如範例 2 |
| 4 | {{score.subtask4}} | 無額外限制 |
